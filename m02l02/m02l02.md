## Занятие 2: Основы поиска элементов при помощи CSS Selector и XPATH

### 1. Основы CSS Selector
CSS-селектор — это часть CSS-кода, которая указывает, к каким элементам HTML должен применяться определённый стиль. Селекторы позволяют указать, какие элементы на веб-странице будут затронуты стилями, описанными в CSS-файле.

**1.1 Основные селекторы**

   - **Типовой селектор**: выбирает элементы по имени тега.
     - Пример: `div` выбирает все элементы `<div>`.
   - **Классовый селектор**: выбирает элементы по значению атрибута `class`.
     - Пример: `.class-name` выбирает все элементы с классом `class-name`.
   - **Идентификатор**: выбирает элемент по значению атрибута `id`.
     - Пример: `#id-name` выбирает элемент с ID `id-name`.
   - **Атрибутный селектор**: выбирает элементы по атрибуту или его значению.
     - Пример: `[type='text']` выбирает все элементы с атрибутом `type`, равным `text`.
   - **Комбинированные селекторы**:
     - **Дочерние селекторы**: `parent > child` выбирает только прямых детей.
       - Пример: `ul > li` выбирает `<li>` элементы, которые являются непосредственными детьми `<ul>`.
     - **Потомковые селекторы**: `ancestor descendant` выбирает все потомки, независимо от уровня.
       - Пример: `div p` выбирает все `<p>` элементы внутри `<div>`, на любом уровне.
     - **Соседние селекторы**: `prev + next` выбирает элемент, который следует сразу после указанного.
       - Пример: `h1 + p` выбирает первый `<p>`, который идет сразу после `<h1>`.
     - **Все последующие элементы**: `prev ~ siblings` выбирает все элементы, следующие за указанным элементом.
       - Пример: `h1 ~ p` выбирает все `<p>` элементы, которые следуют за `<h1>` на том же уровне вложенности.

**1.2 Псевдоклассы и псевдоэлементы**

   - **Псевдоклассы**:
     - `:hover` — применяется к элементу при наведении курсора.
     - `:first-child` — выбирает первый дочерний элемент родителя.
     - `:nth-child(n)` — выбирает n-й дочерний элемент (где n может быть числом, ключевым словом или выражением).
   - **Псевдоэлементы**:
     - `::before` — вставляет контент перед содержимым элемента.
     - `::after` — вставляет контент после содержимого элемента.

**1.3 Примеры использования CSS Selector**

   - **Выбор всех абзацев в элементе с классом `content`**:
     ```css
     .content p 
     ```
   - **Выбор первого абзаца в элементе с классом `content`**:
     ```css
     .content p:first-of-type
     ```

### 2. Основы XPATH
XPath (XML Path Language) — это язык запросов, используемый для навигации и выборки данных из XML и HTML документов. Он предоставляет способ определить, какие элементы и атрибуты должны быть извлечены из документа, и позволяет выполнять сложные запросы и манипуляции с содержимым.

**2.1 Основы синтаксиса**

   - **Абсолютные пути**: начинаются с корневого узла `/`.
     - Пример: `/html/body/div` выбирает `div`, находящийся внутри `body` в корневом узле `html`.
   - **Относительные пути**: начинаются с двойного слэша `//`.
     - Пример: `//div` выбирает все `div` элементы в документе.
   - **Выбор по имени тега**:
     - Пример: `//div` выбирает все элементы `<div>`.
   - **Выбор по атрибутам**:
     - Пример: `//input[@type='text']` выбирает все `input` элементы с атрибутом `type`, равным `text`.
   - **Функции**:
     - **`text()`**: выбирает текстовое содержимое.
       - Пример: `//p[text()='Hello']` выбирает `<p>` элементы с текстом "Hello".
     - **`contains()`**: проверяет наличие подстроки в атрибуте или тексте.
       - Пример: `//div[contains(@class, 'example')]` выбирает все `div` элементы с классом, содержащим "example".
     - **`@attribute`**: выбирает элементы по значению атрибута.
       - Пример: `//a[@href='https://example.com']` выбирает `<a>` элементы с указанным значением `href`.
     - **`position()`**: выбирает элемент по его позиции в наборе узлов.
       - Пример: `(//li)[1]` выбирает первый элемент `<li>` из списка.

**2.2 Примеры использования XPATH**

   - **Выбор всех элементов `<p>` внутри элемента `<div>` с ID `main`**:
     ```xpath
     //div[@id='main']//p
     ```
   - **Выбор последнего `<p>` элемента в элементе `<div>` с классом `content`**:
     ```xpath
     //div[@class='content']//p[last()]
     ```

**2.3 Рекомендации**
- Не используйте селекторы вида //div[1]/div[2]/div[3] без крайней нужды: по такому селектору невозможно с первого раза понять, что за элемент вы ищете. А когда структура страницы хоть немного изменится, ваш парсер с большой вероятностью перестанет работать.
- Не стоит использовать разные расширения для браузеров по поиску XPath: они подбирают нечитабельные и переусложненные селекторы. Лучше потратить немного времени и разобраться в синтаксисе самостоятельно, тем более, что он не очень сложный.

### 3. Сравнение CSS и XPATH для выбора элементов

**3.1 Простота и читаемость**

   - **CSS**:
     - Более простой и интуитивно понятный для выбора элементов.
     - Хорошо подходит для быстрой выборки элементов по классам и ID.
   - **XPATH**:
     - Более сложный синтаксис, но предоставляет мощные инструменты для выбора элементов.
     - Подходит для сложных запросов и навигации по структуре документа.

**3.2 Функциональность**

   - **CSS**:
     - Хорош для выбора элементов по классам, ID, типам тегов и простым атрибутам.
     - Ограничен в возможностях для выбора элементов по тексту или сложным условиям.
   - **XPATH**:
     - Предлагает более сложные возможности для выбора элементов, включая фильтрацию по тексту, атрибутам, позициям и т.д.
     - Позволяет строить более гибкие запросы и извлекать данные из сложных структур.

**3.3 Производительность**

   - **CSS**:
     - Обычно быстрее для рендеринга в браузере, так как обработка CSS-селекторов оптимизирована.
   - **XPATH**:
     - Может быть медленнее, особенно при выполнении сложных запросов, так как требует анализа структуры документа.

**3.4 Примеры применения**

   - **CSS**:
       ```css
       div.footer a[href^='http']
       ```
   - **XPATH**:
       ```xpath
       //div[@class='footer']//a[starts-with(@href, 'http')]
       ```

### 4. Рекомендации по использованию CSS selector и XPATH

**1. Для простых задач:**

- **CSS селекторы** лучше подходят, если задача заключается в выборе элементов по простым критериям, таким как класс, ID или тип элемента. Они обычно проще в использовании и быстрее в обработке.

**2. Для сложных задач:**

- **XPath** лучше подходит для более сложных задач, таких как выбор элементов на основе их текста, работа с атрибутами на основе подстрок, выбор элементов по их положению в иерархии и другие сложные запросы.

**3. Кросс-совместимость:**

- **Убедитесь в совместимости**: Если ваш скрейпер будет работать с различными библиотеками или инструментами, убедитесь, что выбранный вами метод (CSS или XPath) поддерживается этими инструментами.

**4. Проверка и отладка:**

- **Проверяйте запросы**: Всегда проверяйте свои запросы на тестовых данных, чтобы убедиться, что они правильно выбирают элементы, которые вам нужны.

**5. Комбинирование методов:**

- **Используйте комбинацию методов**: В некоторых случаях можно использовать комбинацию CSS селекторов и XPath для достижения лучших результатов, особенно если одно из решений ограничено по функциональности.

### Домашнее задание
Изучить структуру сайта https://rfspager.app/pager  
Написать CSS селекторы и XPATH для получения заголовка таблицы и для получения каждой строки таблицы. Также напишите указатели для получения email с этой страницы (email находится в футтере - в нижней части сайта)

### Ресурсы

- Сайт, используемый на занятии: https://rfspager.app/pager
- CSS selectors cheatsheet: https://www.w3schools.com/cssref/css_selectors.php
- XPATH cheatsheet: https://devhints.io/xpath#axes

















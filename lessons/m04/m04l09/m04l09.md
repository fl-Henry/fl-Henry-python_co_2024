# Занятие 9: Визуализация данных

## 1. Введение в визуализацию данных

### **Значение визуализации данных в анализе**

Визуализация данных играет ключевую роль в анализе данных. Она помогает:

- **Обнаруживать закономерности и тенденции**: Графики и диаграммы позволяют легко заметить скрытые тренды, корреляции и аномалии, которые сложно уловить в больших наборах числовых данных.
  
  Например, на линейном графике можно быстро увидеть, как меняются данные по времени, или обнаружить сезонные колебания.

- **Упрощать восприятие сложной информации**: Визуализация превращает абстрактные цифры и статистику в наглядные формы, которые быстрее воспринимаются. Человеческий мозг легче воспринимает визуальные образы, чем сырые числовые данные.

  Например, круговая диаграмма может быстро показать пропорциональные соотношения категорий, а столбчатая — сравнение величин.

- **Привлекать внимание к ключевым выводам**: Визуализация позволяет выделить важные моменты, которые могут быть затменины в таблицах. Это особенно полезно для представления результатов анализа широкой аудитории, которая может не быть знакома с техническими аспектами данных.

- **Обеспечивать наглядность и интерпретацию**: Хорошо оформленные графики помогают более точно интерпретировать результаты анализа и легче представить их другим. Это важно для принятия обоснованных решений на основе данных.

### **Роль библиотеки Pandas в обработке и подготовке данных для визуализации**

Pandas — это мощная библиотека Python, предназначенная для работы с данными в табличной форме (например, DataFrame и Series). Она активно используется для **предобработки и анализа данных**, что делает её важной частью процесса визуализации:

- **Загрузка и очистка данных**: Прежде чем визуализировать данные, их часто необходимо загрузить из разных источников (CSV, Excel, базы данных), очистить от пропусков и аномальных значений. Pandas предоставляет удобные функции для импорта данных и их предварительной обработки, таких как `pd.read_csv()`, `dropna()`, `fillna()`, и многие другие.

- **Агрегация и фильтрация**: Для правильной визуализации данных часто нужно агрегировать данные, например, вычисляя среднее значение, суммы или медиану по группам. Pandas поддерживает операции группировки через метод `.groupby()` и функции агрегации (например, `.mean()`, `.sum()`), что позволяет подготовить данные для последующей визуализации.

- **Манипуляция с временными рядами**: Pandas предоставляет удобные инструменты для работы с временными данными, что делает его особенно полезным для построения временных графиков. Например, можно легко преобразовывать строки в datetime-форматы, а также изменять частоту данных (например, агрегация по дням, месяцам).

- **Интеграция с визуализационными библиотеками**: Хотя сама библиотека Pandas предоставляет базовые возможности для визуализации через метод `.plot()`, она тесно интегрирована с более мощными библиотеками визуализации, такими как **Matplotlib** и **Seaborn**. Это позволяет создавать более сложные и информативные графики, расширяя возможности Pandas.

- **Преобразование данных для графиков**: Иногда данные требуют дополнительной обработки перед визуализацией: нормализация, создание новых признаков, фильтрация значений или создание категориальных переменных. Pandas предоставляет все инструменты для эффективной подготовки данных перед их представлением на графиках.

В целом, **Pandas** — это «первичный этап» обработки данных, где происходит подготовка и очистка данных, а затем эти данные можно визуализировать с помощью простых встроенных функций или экспортировать в более сложные визуализационные библиотеки.

## 2. Базовая визуализация данных в Pandas

### **Использование метода `plot()` в Pandas**

Метод `.plot()` является основным инструментом для визуализации данных в Pandas. Он позволяет создавать графики напрямую из объекта DataFrame или Series, делая процесс визуализации очень простым и интуитивно понятным.

**Пример базового использования:**
```python
import pandas as pd
import matplotlib.pyplot as plt

# Создаем пример данных
data = pd.Series([3, 7, 5, 8, 4, 6], index=[1, 2, 3, 4, 5, 6])

# Строим график
data.plot()

# Показать график
plt.show()
```
В данном примере метод `plot()` применяется к объекту Series и строит линейный график, где ось X — это индекс, а ось Y — значения из Series.

- **Параметры метода `plot()`**: 
  - Для DataFrame можно строить графики по отдельным столбцам или по всей таблице.
  - `.plot()` автоматически выбирает тип графика в зависимости от структуры данных. Например, если данные числовые, то по умолчанию строится линейный график.
  - Если у вас есть несколько столбцов в DataFrame, то метод `plot()` может строить несколько линий на одном графике, используя разные цвета для каждого столбца.

**Пример с DataFrame:**
```python
data = pd.DataFrame({
    'A': [1, 3, 2, 5, 4],
    'B': [2, 4, 3, 6, 5]
})

data.plot()
plt.show()
```
В данном случае будет построен график с двумя линиями — одна для столбца `A`, другая для столбца `B`.

### **Типы графиков: линии, столбцы, гистограммы, диаграммы рассеяния**

Метод `.plot()` позволяет строить различные типы графиков, в зависимости от параметров, переданных в метод. Вот несколько наиболее популярных типов:

- **Линейный график (Line Plot)**  
  Это тип графика по умолчанию для данных в Pandas. Он хорошо подходит для отображения временных рядов или тенденций по данным.
  
  Пример:
  ```python
  data.plot(kind='line')
  ```

- **Столбчатый график (Bar Plot)**  
  Используется для визуализации категориальных данных или сравнений между отдельными категориями. Часто используется, когда важно показать абсолютные значения для разных категорий.
  
  Пример:
  ```python
  data.plot(kind='bar')
  ```
  Столбчатые графики могут быть горизонтальными, если передать параметр `kind='barh'`.

- **Гистограмма (Histogram)**  
  Гистограмма используется для анализа распределения данных. Она разбивает данные на интервалы (бини) и отображает частоту появления значений в каждом интервале.
  
  Пример:
  ```python
  data.plot(kind='hist', bins=10)
  ```

- **Диаграмма рассеяния (Scatter Plot)**  
  Диаграмма рассеяния используется для визуализации зависимости между двумя числовыми переменными. Это полезно для обнаружения корреляций и закономерностей между переменными.
  
  Пример:
  ```python
  data.plot(kind='scatter', x='A', y='B')
  ```

### **Настройки графиков (основные параметры: цвет, стиль линии, заголовки)**

Pandas использует библиотеку Matplotlib для отображения графиков, что означает, что большинство параметров графиков можно настроить с помощью Matplotlib.

- **Цвет графика**  
  Для изменения цвета линии или столбцов можно использовать параметр `color`. Например:
  ```python
  data.plot(kind='line', color='red')
  ```
  Также можно указать цвет в формате HEX, например `color='#FF5733'`, или использовать стандартные названия цветов, как `blue`, `green`, `black` и т.д.

- **Стиль линии (Line Style)**  
  Параметр `linestyle` позволяет изменить тип линии на графике:
  - `'solid'` — сплошная линия (по умолчанию).
  - `'dashed'` — пунктирная линия.
  - `'dotted'` — точечная линия.
  
  Пример:
  ```python
  data.plot(kind='line', linestyle='--', color='blue')
  ```

- **Маркер на графике**  
  Для того чтобы добавить маркеры на линии (точки на графике), можно использовать параметр `marker`. Например:
  ```python
  data.plot(kind='line', marker='o', color='green')
  ```
  Где `'o'` — это круглый маркер. Существуют и другие варианты маркеров, такие как `'*'`, `'+'`, `'x'`, `'s'` и другие.

- **Заголовки и подписи осей**  
  Для добавления заголовка графика и подписей осей можно использовать Matplotlib команды:
  ```python
  ax = data.plot(kind='line', color='blue')
  ax.set_title('Мой график')
  ax.set_xlabel('Время')
  ax.set_ylabel('Значение')
  ```
  В этом примере мы устанавливаем заголовок графика с помощью метода `set_title()`, а также подписи для осей X и Y.

- **Легенда графика**  
  Легенда используется для объяснения значений разных линий или столбцов. В Pandas легенда добавляется автоматически, если несколько линий присутствуют на одном графике. Чтобы настроить легенду вручную, можно использовать:
  ```python
  ax.legend(['Первая линия', 'Вторая линия'])
  ```


**Пример полного графика:**
```python
import pandas as pd
import matplotlib.pyplot as plt

# Пример данных
data = pd.DataFrame({
    'A': [1, 3, 2, 5, 4],
    'B': [2, 4, 3, 6, 5]
})

# Строим график с настройками
ax = data.plot(kind='line', linestyle='-', color='purple', marker='o')
ax.set_title('График зависимости данных')
ax.set_xlabel('Индекс')
ax.set_ylabel('Значение')

# Показать график
plt.show()
```

Этот код создаст линейный график для двух столбцов, с оранжевыми маркерами и заголовками для осей и графика.

## 3. Настройка графиков с помощью Matplotlib

### **Как интегрировать Matplotlib с Pandas для кастомизации графиков**

Pandas использует библиотеку **Matplotlib** для построения и отображения графиков. Это позволяет значительно расширить возможности визуализации, поскольку Matplotlib предлагает множество инструментов для кастомизации графиков. Метод `.plot()` в Pandas автоматически вызывает Matplotlib для отображения графиков, но для более детальной настройки и улучшения внешнего вида графиков, вам нужно будет использовать Matplotlib напрямую.

**Основные моменты интеграции:**

1. **Построение графиков с помощью Pandas и Matplotlib**:  
   Метод `.plot()` в Pandas возвращает объект Matplotlib `AxesSubplot`, который позволяет дополнительно настроить график с помощью Matplotlib.

   Пример:
   ```python
   import pandas as pd
   import matplotlib.pyplot as plt

   # Пример данных
   data = pd.Series([3, 7, 5, 8, 4, 6], index=[1, 2, 3, 4, 5, 6])

   # Строим график через Pandas
   ax = data.plot()

   # Кастомизация через Matplotlib
   ax.set_title('Простой график')
   ax.set_xlabel('Индекс')
   ax.set_ylabel('Значение')

   # Показать график
   plt.show()
   ```

2. **Преимущества использования Matplotlib**:  
   Pandas предоставляет только базовую настройку графиков, а Matplotlib открывает более глубокие возможности:
   - Настройка внешнего вида линий, маркеров и цветов.
   - Добавление вторичных осей.
   - Управление визуальными аспектами, такими как шрифты, размеры, стили и многое другое.

### **Работа с осями и метками**

Оси на графике — это неотъемлемая часть визуализации, и настройка их параметров имеет большое значение для правильного восприятия графика. В Matplotlib можно полностью контролировать внешний вид осей и меток.

- **Оси X и Y**:  
  Используя объект `AxesSubplot` (например, `ax`), вы можете настроить оси с помощью методов:
  - `set_xlim()` и `set_ylim()` — для установки диапазонов значений на осях.
  - `set_xticks()` и `set_yticks()` — для задания точек, в которых будут располагаться метки.
  - `set_xticklabels()` и `set_yticklabels()` — для задания пользовательских меток.

  Пример:
  ```python
  ax.set_xlim(0, 6)  # Диапазон оси X
  ax.set_ylim(0, 10)  # Диапазон оси Y
  ax.set_xticks([1, 2, 3, 4, 5, 6])  # Метки на оси X
  ax.set_yticks([0, 2, 4, 6, 8, 10])  # Метки на оси Y
  ax.set_xticklabels(['A', 'B', 'C', 'D', 'E', 'F'])  # Пользовательские метки для оси X
  ```

- **Форматирование меток**:  
  Вы можете настроить шрифты, повороты и другие параметры меток осей:
  ```python
  ax.set_xticklabels(['A', 'B', 'C', 'D', 'E'], fontsize=12, rotation=45)
  ```

  В этом примере метки на оси X будут повернуты на 45 градусов, а шрифт будет иметь размер 12.

- **Дополнительные оси**:  
  Matplotlib позволяет добавлять вторичные оси (например, для отображения данных в разных единицах измерения):
  ```python
  ax2 = ax.twinx()  # Добавление второй оси Y
  ax2.plot(data, color='r')
  ```

  Это полезно, если вам нужно сравнивать две переменные с разными диапазонами значений.

### **Заголовки, легенды, подписи осей**

Добавление заголовков и подписей осей улучшает восприятие графиков, делая их более информативными.

- **Заголовок**:  
  Заголовок графика помогает объяснить, о чем идет речь на графике. Его можно добавить с помощью метода `set_title()`.
  ```python
  ax.set_title('Мой заголовок графика', fontsize=14)
  ```

- **Подписи осей**:  
  Подписи осей помогают понять, что именно измеряется вдоль каждой оси. Для добавления подписей используется метод `set_xlabel()` для оси X и `set_ylabel()` для оси Y:
  ```python
  ax.set_xlabel('Время', fontsize=12)
  ax.set_ylabel('Количество', fontsize=12)
  ```

- **Легенда**:  
  Легенда объясняет, какие данные отображаются на графике, и обычно используется, когда на одном графике несколько линий. Легенду можно добавить с помощью метода `legend()`. В Pandas, если вы строите график с несколькими столбцами или сериям, легенда добавляется автоматически.

  Пример:
  ```python
  ax.plot(data['A'], label='Столбец A')
  ax.plot(data['B'], label='Столбец B')
  ax.legend(loc='upper left')  # Позиция легенды
  ```

  Вы можете также настроить расположение легенды, шрифт, границу и другие параметры.

### **Сохранение графиков в различных форматах**

Matplotlib позволяет сохранять графики в различные форматы, такие как PNG, PDF, SVG и другие. Это очень полезно, если вы хотите сохранить графики для дальнейшего использования или отчетов.

- **Сохранение в файл**:  
  Чтобы сохранить график, используйте функцию `savefig()`:
  ```python
  plt.savefig('my_plot.png', dpi=300)  # Сохраняет график в формате PNG с разрешением 300 dpi
  ```

  - `dpi` — это параметр разрешения (dots per inch), который контролирует качество изображения.
  - Вы можете сохранить график в разных форматах, указав соответствующие расширения в имени файла (например, `.pdf`, `.jpg`, `.svg`).

- **Параметры сохранения**:  
  Matplotlib позволяет детально настраивать параметры сохранения:
  - `bbox_inches='tight'` — для уменьшения пустого пространства вокруг графика.
  - `transparent=True` — чтобы сделать фон графика прозрачным (например, для использования в веб-дизайне).

  Пример:
  ```python
  plt.savefig('plot_with_border.png', dpi=300, bbox_inches='tight')
  ```

- **Показывание графика**:  
  После построения графика его можно отобразить на экране с помощью `plt.show()`. Это не обязательно для сохранения графика, но полезно для предварительного просмотра.
  ```python
  plt.show()
  ```

### **Пример полного графика с настройками**

```python
import pandas as pd
import matplotlib.pyplot as plt

# Пример данных
data = pd.Series([3, 7, 5, 8, 4, 6], index=[1, 2, 3, 4, 5, 6])

# Строим график
ax = data.plot(kind='line', color='blue', marker='o', linestyle='-', markersize=8)

# Кастомизация
ax.set_title('График с кастомизацией', fontsize=16)
ax.set_xlabel('Индекс', fontsize=12)
ax.set_ylabel('Значения', fontsize=12)
ax.set_xlim(0, 7)
ax.set_ylim(0, 10)

# Легенда
ax.legend(['Данные'], loc='upper left')

# Сохранение графика
plt.savefig('custom_plot.png', dpi=300, bbox_inches='tight')

# Показать график
plt.show()
```

## 4. Работа с данными временных рядов

### **Визуализация временных рядов с Pandas**

Pandas имеет встроенные функции для работы с временными рядами и для их визуализации. Метод `.plot()` может быть использован для построения графиков временных рядов, где ось X — это временная метка, а ось Y — значения соответствующих данных.

**Пример:**
```python
import pandas as pd
import matplotlib.pyplot as plt

# Создаем пример данных
data = pd.Series([5, 12, 14, 23, 23, 31],
                 index=pd.date_range('2023-01-01', periods=6, freq='D'))

# Строим график
data.plot()

# Показываем график
plt.show()
```

В этом примере создается объект Series с временными метками от 2023-01-01, и частота (периодичность) указана как дневная (`freq='D'`). Метод `pd.date_range()` используется для генерации последовательности дат. На графике временная ось автоматически будет отсортирована, а значения (5, 12, 14, ...) будут отображаться вдоль оси Y.

**Дополнительные настройки:**
1. **Автоматическое форматирование дат**: Время на оси X будет автоматически форматироваться в зависимости от плотности данных (если данные плотные, даты будут выводиться с интервалами; если нет, каждая дата будет отображена).

2. **Тип графика**: Обычно для временных рядов используются линейные графики, так как они хорошо отображают изменения значений во времени.

3. **Настройки осей**: В случае плотных данных, для улучшения визуализации можно использовать методы из Matplotlib для изменения формата отображения дат.

```python
import matplotlib.dates as mdates

# Настроим отображение дат на оси X
plt.gca().xaxis.set_major_formatter(mdates.DateFormatter('%Y-%m-%d'))
plt.gca().xaxis.set_major_locator(mdates.DayLocator())
```

### **Преобразование дат и времени для визуализации**

Работа с временными рядами в Pandas требует правильного представления временных меток. Часто данные хранятся в виде строк или чисел, и их нужно преобразовать в формат временных меток (тип `datetime`), чтобы работать с ними эффективно.

**Преобразование строк в datetime:**

1. **Использование `pd.to_datetime()`**:  
   Функция `pd.to_datetime()` позволяет преобразовывать строки или другие типы данных в формат `datetime`. Это нужно для правильной работы с временными рядами и для их визуализации.

   Пример:
   ```python
   # Преобразование строки в datetime
   df = pd.DataFrame({
       'date': ['2023-01-01', '2023-01-02', '2023-01-03'],
       'value': [10, 20, 30]
   })

   df['date'] = pd.to_datetime(df['date'])

   # Проверка типа данных
   print(df['date'].dtype)  # datetime64[ns]
   ```

2. **Форматирование времени**:  
   Иногда вам нужно преобразовать время в другой формат. Например, извлечь год, месяц или день, чтобы использовать их для группировки или агрегации данных.
   
   Пример:
   ```python
   # Извлечение года из временной метки
   df['year'] = df['date'].dt.year
   ```

3. **Использование `pd.to_datetime()` для временных интервалов**:  
   Если ваши данные содержат интервалы времени, такие как '2023-01-01 12:00:00', вы можете указать точный формат даты и времени, используя параметр `format` в `pd.to_datetime()`:
   ```python
   df['datetime'] = pd.to_datetime(df['datetime'], format='%Y-%m-%d %H:%M:%S')
   ```

**Пример преобразования:**

```python
data = pd.DataFrame({
    'date': ['2023-01-01', '2023-01-02', '2023-01-03'],
    'sales': [150, 200, 250]
})

data['date'] = pd.to_datetime(data['date'])
data.set_index('date', inplace=True)

# Строим график
data.plot()
plt.show()
```

### **Разделение и агрегирование данных по времени**

Одним из важнейших аспектов работы с временными рядами является **агрегация** данных. В Pandas это можно легко сделать с помощью метода `resample()`, который позволяет группировать данные по временным интервалам (например, по дням, неделям, месяцам).

**Разделение данных по времени:**
1. **Использование метода `resample()`**:  
   Метод `resample()` позволяет изменять частоту временных рядов. Он работает аналогично методу `groupby()`, но вместо категориальных данных использует временные интервалы. Этот метод полезен, если нужно агрегировать данные на различные интервалы, например, вычислить ежемесячные или еженедельные значения.

   Пример:  
   Аггрегирование данных по месяцам.
   ```python
   data = pd.DataFrame({
       'date': pd.date_range('2023-01-01', periods=365, freq='D'),
       'sales': range(1, 366)
   })

   data.set_index('date', inplace=True)

   # Агрегируем данные по месяцам
   monthly_data = data.resample('ME').sum()  # 'ME' - месяц
   monthly_data.plot()
   plt.show()
   ```

   В этом примере создаются данные с ежедневными продажами, и затем эти данные агрегируются по месяцам с помощью `resample('ME')`, где `'ME'` — это частота, указывающая на месячные интервал. Метод `.sum()` используется для суммирования значений на каждый месяц.

2. **Агрегирование с разными функциями**:  
   Вы можете использовать различные функции агрегирования, такие как `sum()`, `mean()`, `max()`, `min()`, и другие. Это позволяет гибко агрегировать данные по времени.

   Пример:
   ```python
   weekly_data = data.resample('W').mean()  # Среднее по неделям
   weekly_data.plot()
   plt.show()
   ```

3. **Группировка по годам, месяцам и дням**:  
   Вы можете группировать данные по разным временным интервалам:
   - `'A'` — по годам (Annual).
   - `'M'` — по месяцам (Monthly).
   - `'W'` — по неделям (Weekly).
   - `'D'` — по дням (Daily).

   Пример:
   ```python
   yearly_data = data.resample('A').mean()  # Среднее по годам
   ```

4. **Применение агрегации для сдвига данных (Rolling)**:  
   Если вы хотите анализировать данные с учётом их скользящих средних или других агрегаций на основе окна, используйте метод `rolling()`:
   ```python
   rolling_avg = data['sales'].rolling(window=7).mean()  # 7-дневное скользящее среднее
   rolling_avg.plot()
   plt.show()
   ```

## 5. Использование Pandas для визуализации многомерных данных

Многомерные данные представляют собой информацию, которая содержит более одной переменной. Визуализация многомерных данных помогает лучше понять, как различные переменные взаимодействуют друг с другом, выявить закономерности и аномалии, а также провести более глубокий анализ. В этом разделе мы рассмотрим несколько методов визуализации, которые широко применяются для работы с многомерными данными в библиотеке Pandas и других инструментах, таких как **Seaborn** и **Matplotlib**.

### **Создание матричных диаграмм (heatmap)**

**Heatmap** (тепловая карта) — это визуализация, которая позволяет отобразить многомерные данные в виде цветовой матрицы, где цвет каждого элемента соответствует значению в матрице. Тепловые карты особенно полезны для отображения корреляции между переменными или для анализа данных, имеющих структуру матрицы, например, когда нужно показать взаимодействие между несколькими переменными.

**Основные этапы создания heatmap:**
1. **Корреляция между переменными**: Одним из самых распространённых применений тепловых карт является визуализация матрицы корреляции между переменными. Корреляция измеряет степень зависимости одной переменной от другой.

2. **Использование Seaborn для построения heatmap**:  
   Библиотека **Seaborn** интегрируется с Pandas и Matplotlib и предоставляет простой интерфейс для построения сложных визуализаций. Для создания тепловой карты можно использовать функцию `heatmap()`.

**Пример:**
```python
import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt

# Создаем пример данных
data = pd.DataFrame({
    'A': [1, 2, 3, 4, 5],
    'B': [5, 4, 3, 2, 1],
    'C': [2, 3, 4, 5, 6],
    'D': [6, 5, 4, 3, 2]
})

# Вычисляем корреляцию
corr_matrix = data.corr()

# Строим тепловую карту
sns.heatmap(corr_matrix, annot=True, cmap='coolwarm', fmt='.2f', linewidths=0.5)

# Показать график
plt.show()
```

**Пояснение:**
- В этом примере создается датафрейм `data`, состоящий из четырёх числовых столбцов. Мы используем метод `.corr()` для вычисления корреляционной матрицы, которая затем передается в функцию `sns.heatmap()`.
- Параметр `annot=True` добавляет числовые значения в ячейки тепловой карты.
- Параметр `cmap='coolwarm'` указывает цветовую палитру, где красный и синий цвета показывают сильную отрицательную и положительную корреляцию соответственно.
- `fmt='.2f'` задает формат чисел с двумя знаками после запятой.
- `linewidths=0.5` добавляет линии разделения ячеек в тепловой карте.

Тепловая карта помогает визуально оценить степень связи между переменными. Чем ближе коэффициент корреляции к 1 или -1, тем сильнее взаимосвязь между переменными.

### **Парные графики для анализа нескольких переменных (Pair plot)**

**Pair plot** — это способ визуализации всех парных комбинаций переменных в многомерном наборе данных. Для каждой пары переменных отображается диаграмма рассеяния, а вдоль диагонали обычно отображаются гистограммы или плотности распределений.

Парные графики идеально подходят для выявления корреляций между переменными, а также для изучения распределений каждой из переменных в наборе данных.

**Пример:**
```python
import seaborn as sns
import pandas as pd

# Пример набора данных
data = sns.load_dataset('iris')  # Загрузим встроенный набор данных 'iris'

# Создание парного графика
sns.pairplot(data, hue='species', diag_kind='kde', markers='o')

# Показать график
plt.show()
```

**Пояснение:**
- В этом примере используется встроенный набор данных `iris`, который содержит информацию о трех типах ирисов (Species) и их характеристиках (длина и ширина чашелистика и лепестка).
- Параметр `hue='species'` позволяет различать разные виды ирисов цветом.
- `diag_kind='kde'` указывает, что вдоль диагонали будут отображаться **плотности распределения** (Kernel Density Estimation, KDE), а не гистограммы.
- `markers='o'` изменяет форму маркеров на графиках рассеяния (в данном случае на круглые).

Парный график отображает несколько диаграмм рассеяния, где каждая точка представляет пару значений для двух переменных, и помогает выявить взаимосвязь между ними. Это эффективный способ для быстрой диагностики зависимостей в многомерных данных.

### **Диаграммы с субплотами для сравнения данных**

Иногда нужно сравнить данные, которые представляют собой несколько подмножеств в пределах одного набора данных. В таком случае удобно использовать **субплоты** (subplots). Субплоты позволяют разместить несколько графиков в одном окне, что упрощает сравнение разных наборов данных.

**Как использовать субплоты в Pandas и Matplotlib:**
1. **Создание нескольких графиков на одном изображении**: В Matplotlib есть функция `plt.subplots()`, которая позволяет создать несколько графиков на одном экране. Вы можете использовать её совместно с Pandas для визуализации различных аспектов многомерных данных.

2. **Деление данных на категории**: Разделение данных по категориям или группам и отображение каждого из этих подмножеств на отдельном графике позволяет проще увидеть различия между ними.

#### Пример:
```python
import pandas as pd
import matplotlib.pyplot as plt

# Пример данных
data = pd.DataFrame({
    'Category': ['A', 'B', 'A', 'B', 'A', 'B'],
    'Value1': [10, 15, 20, 25, 30, 35],
    'Value2': [1, 2, 3, 4, 5, 6]
})

# Создание субплотов
fig, axs = plt.subplots(1, 2, figsize=(12, 5))

# Строим графики
data[data['Category'] == 'A'].plot(x='Value1', y='Value2', kind='scatter', ax=axs[0], color='blue')
data[data['Category'] == 'B'].plot(x='Value1', y='Value2', kind='scatter', ax=axs[1], color='red')

# Настройки
axs[0].set_title('Категория A')
axs[1].set_title('Категория B')

plt.tight_layout()
plt.show()
```

**Пояснение:**
- Мы создаём датафрейм с двумя столбцами значений (`Value1`, `Value2`) и категорией (`Category`).
- Используется метод `plt.subplots()` для создания одного окна с двумя субплотами. Параметр `figsize=(12, 5)` задаёт размер изображения.
- Каждый субплот отображает диаграмму рассеяния для данных, принадлежащих одной из категорий — `A` или `B`.
- `axs[0]` и `axs[1]` — это доступ к каждому из субплотов.
- Метод `plt.tight_layout()` автоматически регулирует расстояние между субплотами для улучшения визуализации.

Субплоты дают возможность удобно сравнивать различные аспекты данных, группируя их по категориям или условиям, и упрощают визуальный анализ.

## 6. Интерактивная визуализация

Интерактивная визуализация — это важный шаг в развитии аналитических инструментов, так как она позволяет пользователям исследовать данные, взаимодействовать с графиками и динамически изменять параметры отображаемой информации. В отличие от статичных графиков, интерактивные визуализации предоставляют пользователям возможность взаимодействовать с данными, анализировать их в реальном времени и лучше понимать закономерности и аномалии.


### **Преимущества интерактивных графиков**

Интерактивные графики имеют несколько ключевых преимуществ по сравнению с традиционными статичными графиками:

1. **Удобство исследования данных**:  
   Интерактивные графики позволяют пользователям исследовать данные более гибко. Например, можно увеличивать или уменьшать масштаб, чтобы увидеть данные на разных уровнях, фильтровать информацию или просматривать подробности по конкретным точкам данных через всплывающие подсказки.

2. **Динамическое обновление данных**:  
   Возможность динамически изменять данные или параметры графика в реальном времени делает графики более информативными. Пользователи могут менять фильтры, скрывать или показывать определенные данные, обновляя график в зависимости от их выбора.

3. **Показывание дополнительных данных через всплывающие подсказки**:  
   Всплывающие подсказки — это один из ключевых элементов интерактивных графиков. Они позволяют показывать подробную информацию при наведении курсора на точку данных, например, имя объекта, значение переменной или другие метаданные.

4. **Лучшая визуализация сложных взаимосвязей**:  
   Взаимодействие с графиками помогает выявить более сложные закономерности и взаимосвязи между переменными. Это особенно полезно при работе с многомерными данными, когда необходимо проанализировать взаимосвязи между несколькими переменными одновременно.

5. **Повышение вовлеченности пользователей**:  
   Интерактивные графики более привлекают внимание пользователей и могут использоваться в отчетах и презентациях для более глубокого и интересного анализа данных.

### **Введение в библиотеки Plotly и Seaborn для интеграции с Pandas**

**Seaborn** — это высокоуровневая библиотека для визуализации данных в Python однако, несмотря на свою простоту в использовании, Seaborn **не поддерживает интерактивность** "из коробки". Тем не менее, в сочетании с библиотеками, такими как **Plotly** или **Bokeh**, Seaborn позволяет создавать интерактивные графики.

**Интерактивность в Seaborn** можно реализовать с помощью библиотеки **Plotly**, добавив к графикам Seaborn функциональность взаимодействия с пользователем.

**Plotly — Интерактивная визуализация**

**Plotly** — это мощная библиотека для создания интерактивных графиков, которая позволяет строить красивые, динамичные и настраиваемые графики. Plotly поддерживает различные типы визуализаций, такие как линейные графики, столбчатые диаграммы, тепловые карты, карты, диаграммы рассеяния и многие другие.

Основное преимущество Plotly заключается в том, что она **автоматически добавляет интерактивные элементы**, такие как панель масштабирования, возможность выделения и всплывающие подсказки.

**Интеграция Plotly с Pandas**

Plotly прекрасно интегрируется с Pandas. Вы можете использовать Pandas DataFrame напрямую для построения графиков. Например, Plotly позволяет вам передавать DataFrame в функцию для построения интерактивных графиков с минимальной настройкой.

#### Пример:
```python
import plotly.express as px
import pandas as pd

# Пример данных
df = pd.DataFrame({
    'Category': ['A', 'B', 'C', 'D', 'E'],
    'Values': [10, 20, 30, 40, 50]
})

# Построение интерактивного столбчатого графика
fig = px.bar(df, x='Category', y='Values', title='Столбчатая диаграмма')
fig.show()
```

**Пояснение:**
- `px.bar()` — функция из Plotly Express для создания столбчатого графика. Мы передаем DataFrame, где ось X будет представлять категорию, а ось Y — значения.
- `fig.show()` выводит график. Это создаёт интерактивную визуализацию, где можно масштабировать, выделять и изменять представление данных.


### **Основы построения интерактивных графиков с использованием Plotly**

#### **1. Построение интерактивных линейных графиков**

Линейные графики являются одним из самых популярных типов графиков для временных рядов, изменения значений по времени и представления трендов.

```python
import plotly.express as px

# Пример данных временного ряда
df = pd.DataFrame({
    'Date': pd.date_range(start='2023-01-01', periods=10, freq='D'),
    'Value': [1, 3, 2, 5, 4, 7, 6, 8, 9, 10]
})

# Создаем интерактивный линейный график
fig = px.line(df, x='Date', y='Value', title='Временной ряд')
fig.show()
```

**Пояснение:**
- `px.line()` строит линейный график, где по оси X идут даты, а по оси Y — значения.
- В Plotly для интерактивных графиков по умолчанию доступны элементы управления, такие как панель масштабирования и кнопки для отображения информации о точках.

#### **2. Диаграммы рассеяния (Scatter plots)**

Диаграмма рассеяния полезна для отображения взаимосвязей между двумя числовыми переменными.

```python
# Пример данных
df = pd.DataFrame({
    'X': [1, 2, 3, 4, 5],
    'Y': [10, 11, 12, 13, 14]
})

# Построение интерактивной диаграммы рассеяния
fig = px.scatter(df, x='X', y='Y', title='Диаграмма рассеяния')
fig.show()
```

**Пояснение:**
- `px.scatter()` строит диаграмму рассеяния, где ось X и ось Y представляют собой переменные из DataFrame.
- Этот график будет интерактивным: можно навести курсор на точки и получить всплывающее окно с информацией.

#### **3. Построение гистограмм**

Гистограммы показывают распределение переменных и позволяют понять частотность появления значений в определенных диапазонах.

```python
# Пример данных
df = pd.DataFrame({
    'Value': [1, 2, 2, 3, 3, 3, 4, 4, 4, 4]
})

# Построение интерактивной гистограммы
fig = px.histogram(df, x='Value', nbins=4, title='Гистограмма распределения')
fig.show()
```

**Пояснение:**
- `px.histogram()` строит гистограмму для переменной `Value`, где мы также указываем количество корзин для гистограммы с помощью параметра `nbins`.

#### **4. Тепловые карты (Heatmaps)**

Тепловые карты полезны для отображения данных в виде матрицы, где каждый элемент матрицы окрашен в цвет, отражающий величину данных.

```python
import numpy as np

# Пример данных для тепловой карты
data = np.random.rand(10, 10)  # Генерация случайных данных

# Построение интерактивной тепловой карты
fig = px.imshow(data, title='Тепловая карта')
fig.show()
```

**Пояснение:**
- `px.imshow()` строит тепловую карту, где каждый элемент матрицы будет отображён с соответствующим цветом, который отражает величину данных.

#### **5. Добавление всплывающих подсказок**

Plotly позволяет добавлять всплывающие подсказки для отображения дополнительной информации о данных при наведении на точки графиков. Это реализуется через параметр `hover_data`.

```python
df = pd.DataFrame({
    'X': [1, 2, 3, 4, 5],
    'Y': [10, 11, 12, 13, 14]
})

# Построение интерактивной тепловой карты
fig = px.scatter(df, x='X', y='Y', title='Диаграмма рассеяния', hover_data={'Y': False})

fig.show()
```

**Пояснение:**
- `hover_data` позволяет указать, какие дополнительные данные должны быть отображены в подсказке при наведении на точку графика.

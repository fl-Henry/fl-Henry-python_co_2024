<h2 id="m1l5">Занятие 5: Структуры данных и JSON в Python, List Comprehension</h2>

### **1. Списки (list)**

**Определение и создание списка:**
- Список — это изменяемая (mutable) упорядоченная коллекция элементов. Элементы списка могут быть любого типа.
- Списки создаются с помощью квадратных скобок `[]` или функции `list()`.

**Примеры создания:**
```python
my_list = [1, 2, 3, 4, 5]
empty_list = []
another_list = list([10, 20, 30])
```

**Операции с элементами:**
- **Добавление:**
  - `append(item)` — добавляет элемент в конец списка.
  - `extend(iterable)` — добавляет элементы из итерабельного объекта.
  - `insert(index, item)` — вставляет элемент на указанную позицию.

**Примеры:**
```python
my_list.append(6)
my_list.extend([7, 8])
my_list.insert(2, 2.5)
```

- **Удаление:**
  - `pop(index)` — удаляет элемент по индексу и возвращает его. Если индекс не указан, удаляет последний элемент.
  - `remove(item)` — удаляет первый встреченный элемент с указанным значением.
  - `clear()` — удаляет все элементы списка.

**Примеры:**
```python
my_list.pop()       # Удаляет последний элемент
my_list.remove(2.5) # Удаляет элемент 2.5
my_list.clear()     # Очищает список
```

- **Изменение:**
  - Изменение значения элемента происходит через индекс.

**Пример:**
```python
my_list[0] = 100
```

**Индексация и срезы (slicing):**
- Индексация начинается с 0. Отрицательные индексы указывают на элементы с конца списка.
- Срезы позволяют извлечь подсписок.

**Примеры:**
```python
my_list[1]      # Второй элемент
my_list[-1]     # Последний элемент
my_list[1:4]    # Элементы с индекса 1 до 3 (4 не включается)
my_list[:3]     # Элементы с начала до индекса 2
my_list[3:]     # Элементы с индекса 3 до конца
```

**Часто встречающиеся методы:**
- `sort()` — сортирует список на месте.
- `reverse()` — изменяет порядок элементов на обратный.

**Пример:**
```python
my_list.sort()
my_list.reverse()
```

---

### **2. Кортежи (tuple)**

**Определение и создание кортежа:**
- Кортеж — это неизменяемая (immutable) упорядоченная коллекция элементов.
- Создаются с помощью круглых скобок `()` или функции `tuple()`.

**Примеры создания:**
```python
my_tuple = (1, 2, 3, 4)
single_tuple = (1,)    # Кортеж с одним элементом
empty_tuple = ()
```

**Иммутабельность кортежей:**
- Кортежи не могут быть изменены после создания. Нельзя изменять, добавлять или удалять элементы.

**Примеры:**
```python
# Это приведет к ошибке
# my_tuple[1] = 5
```

**Срезы и индексирование:**
- Индексация и срезы аналогичны спискам.

**Примеры:**
```python
my_tuple[1]    # Второй элемент
my_tuple[:3]   # Элементы с начала до индекса 2
```

**Использование кортежей как ключей в словарях:**
- Кортежи могут быть использованы как ключи в словарях, так как они неизменяемы.

**Пример:**
```python
my_dict = {('key1', 'key2'): 'value'}
```

---

### **3. Словари (dict)**

**Определение и создание словаря:**
- Словарь — это изменяемая (mutable) коллекция пар ключ-значение.
- Создаются с помощью фигурных скобок `{}` или функции `dict()`.

**Примеры создания:**
```python
my_dict = {'name': 'Alice', 'age': 25}
empty_dict = {}
another_dict = dict(name='Bob', age=30)
```

**Работа с ключами и значениями:**
- Ключи в словаре должны быть уникальными и неизменяемыми (например, строки, числа или кортежи).
- Значения могут быть любого типа и могут дублироваться.

**Основные методы и операции:**
- `get(key, default=None)` — возвращает значение по ключу, если ключ отсутствует — возвращает значение `default`.
- `update()` — обновляет и/или добавляет новые ключи/значения.
- `keys()` — возвращает список ключей.
- `values()` — возвращает список значений.
- `items()` — возвращает пары ключ-значение.
- `pop(key, default=None)` — удаляет ключ и возвращает значение; если ключ не найден, возвращает `default`.

**Примеры:**
```python
name = my_dict.get('name')
keys = my_dict.keys()
values = my_dict.values()
items = my_dict.items()

my_dict.pop('age')
my_dict.clear()  # Очищает словарь
```

---

### **4. Множества (set)**

**Определение и создание множества:**
- Множество — это неупорядоченная коллекция уникальных элементов.
- Создаются с помощью фигурных скобок `{}` или функции `set()`.

**Примеры создания:**
```python
my_set = {1, 2, 3, 4}
empty_set = set()
```

**Операции с множествами:**
- **Объединение:** `union()` или оператор `|`.
- **Пересечение:** `intersection()` или оператор `&`.
- **Разность:** `difference()` или оператор `-`.

**Примеры:**
```python
set1 = {1, 2, 3}
set2 = {3, 4, 5}

union_set = set1 | set2
intersection_set = set1 & set2
difference_set = set1 - set2
```

**Методы множеств:**
- `add(item)` — добавляет элемент в множество.
- `remove(item)` — удаляет элемент, вызывает ошибку, если элемента нет.
- `discard(item)` — удаляет элемент, не вызывает ошибку, если элемента нет.
- `clear()` — очищает множество.

**Примеры:**
```python
my_set.add(5)
my_set.remove(1)
my_set.discard(10)
my_set.clear()
```

### Работа с JSON

---

### **1. Введение в JSON**

**Что такое JSON (JavaScript Object Notation):**
- JSON — это формат обмена данными, который используется для представления структурированных данных в текстовом виде.
- JSON является текстовым форматом, который легко читаем для человека и прост в обработке для машин.
- Основные типы данных в JSON: объекты (словарь), массивы (списки), строки, числа, булевы значения и `null`.

**Примеры JSON-формата:**

- **JSON-объект** (эквивалент словаря в Python):
  ```json
  {
    "name": "Alice",
    "age": 30,
    "city": "New York"
  }
  ```
  В Python это будет словарь:
  ```python
  {
    'name': 'Alice',
    'age': 30,
    'city': 'New York'
  }
  ```

- **JSON-массив** (эквивалент списка в Python):
  ```json
  [10, 20, 30, 40]
  ```
  В Python это будет список:
  ```python
  [10, 20, 30, 40]
  ```

- **JSON-строка**:
  ```json
  "Hello, world!"
  ```

- **JSON-число**:
  ```json
  123
  ```

- **JSON-булевы значения**:
  ```json
  true
  false
  ```

- **JSON-`null`**:
  ```json
  null
  ```
  В Python это будет `None`.

---

### **2. Чтение и запись JSON в Python**

**Модуль `json`:**
- Python предоставляет модуль `json` для работы с JSON-данными. Модуль позволяет преобразовывать между JSON-форматом и типами данных Python.

**Функции модуля `json`:**

- **`json.dumps()`**
  - Преобразует объект Python в строку JSON.
  - Параметры:
    - `obj` — объект Python для преобразования.
    - `indent` — уровень отступов для форматированного вывода.
    - `sort_keys` — если `True`, ключи словаря будут отсортированы.

  **Пример:**
  ```python
  import json

  data = {'name': 'Alice', 'age': 30, 'city': 'New York'}
  json_str = json.dumps(data, indent=4)
  print(json_str)
  ```

- **`json.loads()`**
  - Преобразует строку JSON в объект Python.
  - Параметры:
    - `s` — строка JSON для преобразования.

  **Пример:**
  ```python
  json_str = '{"name": "Alice", "age": 30, "city": "New York"}'
  data = json.loads(json_str)
  print(data)
  ```

- **`json.dump()`**
  - Записывает объект Python в файл в формате JSON.
  - Параметры:
    - `obj` — объект Python для записи.
    - `fp` — объект файла (например, открытый файл).

  **Пример:**
  ```python
  data = {'name': 'Alice', 'age': 30, 'city': 'New York'}
  print(json.dump(data, file, indent=4))
  ```

- **`json.load()`**
  - Читает JSON-данные из файла и преобразует их в объект Python.
  - Параметры:
    - `fp` — объект файла (например, открытый файл).

  ```python
  data = "{'name': 'Alice', 'age': 30, 'city': 'New York'}"
  data = json.load(data)
  print(data)
  ```

### Списковые включения (List Comprehension)
---

**1. Основы списковых включений**

- **Списковые включения** (List Comprehensions) позволяют создавать новые списки, применяя выражения и операции к существующим итерабельным объектам.
- Общий синтаксис:
  ```python
  [expression for item in iterable]
  ```
  Здесь `expression` — это выражение, которое вычисляется для каждого элемента `item` в `iterable`.

**Примеры:**

- Создание списка квадратов чисел от 0 до 9:
  ```python
  squares = [x**2 for x in range(10)]
  # Результат: [0, 1, 4, 9, 16, 25, 36, 49, 64, 81]
  ```

- Преобразование строк в верхний регистр:
  ```python
  words = ['hello', 'world', 'python']
  upper_words = [word.upper() for word in words]
  # Результат: ['HELLO', 'WORLD', 'PYTHON']
  ```

**Преимущества по сравнению с обычными циклами `for`:**
- **Компактность и читаемость**: Списковые включения позволяют сократить код до одной строки, что делает его более читаемым.
- **Производительность**: Списковые включения часто выполняются быстрее, чем эквивалентные циклы `for`, так как они оптимизированы для быстрого выполнения.

**Cравнение с обычным циклом**

- Обычный цикл `for`:
  ```python
  squares = []
  for x in range(10):
      squares.append(x**2)
  ```

- Списковое включение:
  ```python
  squares = [x**2 for x in range(10)]
  ```

---

### **2. Условия в списковых включениях**

**Использование условных выражений для фильтрации данных:**
- Условные выражения в списковых включениях позволяют фильтровать элементы, которые будут включены в новый список.
- Общий синтаксис:
  ```python
  [expression for item in iterable if condition]
  ```
  Здесь `condition` — это условное выражение, которое определяет, должен ли элемент включаться в результирующий список.

**Примеры:**

- Список квадратов четных чисел от 0 до 9:
  ```python
  even_squares = [x**2 for x in range(10) if x % 2 == 0]
  # Результат: [0, 4, 16, 36, 64]
  ```

- Фильтрация строк по длине:
  ```python
  words = ['hello', 'world', 'python', 'is', 'fun']
  long_words = [word for word in words if len(word) > 3]
  # Результат: ['hello', 'world', 'python', 'fun']
  ```

**Комбинирование нескольких условий:**
- Можно использовать несколько условий для более сложной фильтрации.

**Пример:**
```python
numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9]
filtered = [x for x in numbers if x % 2 == 0 if x > 5]
# Результат: [6, 8]
```

---

### **3. Сложные примеры**

**Вложенные списковые включения:**
- Позволяют обрабатывать и преобразовывать многомерные структуры данных, такие как матрицы.

**Пример: Создание плоского списка из матрицы:**
- Исходная матрица:
  ```python
  matrix = [
      [1, 2, 3],
      [4, 5, 6],
      [7, 8, 9]
  ]
  ```
- Вложенное списковое включение для преобразования матрицы в плоский список:
  ```python
  flattened = [elem for row in matrix for elem in row]
  # Результат: [1, 2, 3, 4, 5, 6, 7, 8, 9]
  ```

**Пример: Применение условия внутри вложенных списковых включений:**
- Извлечение только четных чисел из матрицы:
  ```python
  even_numbers = [elem for row in matrix for elem in row if elem % 2 == 0]
  # Результат: [2, 4, 6, 8]
  ```

**Списковые включения с функциями:**
- Можно использовать функции в списковых включениях для преобразования данных.

**Пример: Применение функции к элементам списка:**
  ```python
  numbers = [1, 2, 3, 4, 5]
  squared_numbers = [float(x) for x in numbers]
  # Результат: [1.0, 4.0, 9.0, 16.0, 25.0]
  ```

**Списковые включения для создания словарей:**
- Создание словаря с использованием списковых включений:

**Пример:**
```python
names = ['Alice', 'Bob', 'Charlie']
name_length_dict = {name: len(name) for name in names}
# Результат: {'Alice': 5, 'Bob': 3, 'Charlie': 7}
```



### Задача 1: Фильтрация и преобразование данных

Имеется список слов, содержащих названия различных фруктов. Необходимо создать новый список, который будет содержать длину каждого слова только для тех фруктов, длина названия которых больше 5 символов. Результат должен быть отсортирован по убыванию длины.

**Вводные данные и ожидаемый результат**
```python
fruits = ['apple', 'banana', 'cherry', 'blueberry', 'kiwi', 'pineapple']
# Ожидаемый результат: [9, 9, 6, 6]
```

### **Задача 2: Преобразование матрицы и фильтрация**

Дана матрица, представляющая собой список списков, где каждый внутренний список содержит числа. Нужно создать один плоский список, который будет содержать только те числа, которые являются четными и больше 10. Сначала создайте плоский список, а затем примените фильтрацию.

**Вводные данные и ожидаемый результат**
```python
matrix = [
    [1, 12, 3],
    [14, 25, 36],
    [7, 8, 19, 20]
]
# Ожидаемый результат: [12, 14, 36, 20]
```